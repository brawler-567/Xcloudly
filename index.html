<!DOCTYPE html>
<html lang="ru">
<head>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xCloudly Music</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="loader-wrapper">
        <div class="loader-container">
            <div class="loader"></div>
            <div class="loader-text">
                <span class="loader-letter">L</span>
                <span class="loader-letter">o</span>
                <span class="loader-letter">a</span>
                <span class="loader-letter">d</span>
                <span class="loader-letter">i</span>
                <span class="loader-letter">n</span>
                <span class="loader-letter">g</span>
                <span class="loader-letter">.</span>
                <span class="loader-letter">.</span>
                <span class="loader-letter">.</span>
            </div>
        </div>
    </div>

    <div class="app-container">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-item active" onclick="showSection('home')">
                        <span class="nav-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12.5 3.247a1 1 0 0 0-1 0L4 7.577V20h4.5v-6a1 1 0 0 1 1-1h5a1 1 0 0 1 1 1v6H20V7.577l-7.5-4.33zm-2-1.732a3 3 0 0 1 3 0l7.5 4.33a2 2 0 0 1 1 1.732V21a1 1 0 0 1-1 1h-6.5a1 1 0 0 1-1-1v-6h-3v6a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7.577a2 2 0 0 1 1-1.732l7.5-4.33z"/>
                            </svg>
                        </span>
                        <span class="nav-text">–ì–ª–∞–≤–Ω–∞—è</span>
                    </div>
                    <div class="nav-item" onclick="showSection('upload')">
                        <span class="nav-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M11.999 3v12.5a3.5 3.5 0 1 1-3.5-3.5H10V7H5.5a5.5 5.5 0 1 0 5.5 5.5v-1.5a3.5 3.5 0 1 1 3.5 3.5h-1.5V13a5.5 5.5 0 1 0-5.5-5.5V3h4.5z"/>
                            </svg>
                        </span>
                        <span class="nav-text">–î–æ–±–∞–≤–∏—Ç—å –º—É–∑—ã–∫—É</span>
                    </div>
                </div>

                <div class="nav-section">
                    <h3 class="section-title">–í–ê–®–ò –ü–õ–ï–ô–õ–ò–°–¢–´</h3>
                    <div id="playlistsList"></div>
                    <div class="nav-item" onclick="createNewPlaylist()">
                        <span class="nav-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 3a1 1 0 0 0-1 1v7H4a1 1 0 1 0 0 2h7v7a1 1 0 1 0 2 0v-7h7a1 1 0 1 0 0-2h-7V4a1 1 0 0 0-1-1z"/>
                            </svg>
                        </span>
                        <span class="nav-text">–°–æ–∑–¥–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç</span>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content">
            <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–æ–∏—Å–∫–æ–º -->
            <section id="home-section" class="content-section active">
                <header class="content-header">
                    <div class="search-container">
                        <div class="search-box">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–µ—Å–µ–Ω –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∞—Ä—Ç–∏—Å—Ç—É...">
                        </div>
                    </div>
                </header>

                <div class="music-grid" id="searchResults">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
                </div>
            </section>

            <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º—É–∑—ã–∫–∏ -->
            <section id="upload-section" class="content-section">
                <header class="content-header">
                    <h1>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#1db954" style="vertical-align: middle; margin-right: 8px;">
                            <path d="M11.999 3v12.5a3.5 3.5 0 1 1-3.5-3.5H10V7H5.5a5.5 5.5 0 1 0 5.5 5.5v-1.5a3.5 3.5 0 1 1 3.5 3.5h-1.5V13a5.5 5.5 0 1 0-5.5-5.5V3h4.5z"/>
                        </svg>
                        –î–æ–±–∞–≤–∏—Ç—å –º—É–∑—ã–∫—É
                    </h1>
                    <p>–ó–∞–≥—Ä—É–∂–∞–π—Ç–µ MP3 —Ñ–∞–π–ª—ã –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–∞–π—Ç (30 —Å–µ–∫ - 5 –º–∏–Ω)</p>
                </header>

                <div class="upload-container">
                    <!-- Drag & Drop -->
                    <div class="upload-zone" id="uploadZone">
                        <div class="zone-content">
                            <div class="upload-icon">üìÅ</div>
                            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ MP3 —Ñ–∞–π–ª —Å—é–¥–∞</h3>
                            <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
                            <input type="file" id="fileInput" accept="audio/mp3,audio/*" hidden>
                            <button onclick="document.getElementById('fileInput').click()">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</button>
                        </div>
                    </div>

                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ -->
                    <div class="file-info" id="fileInfo" style="display: none;">
                        <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ:</h3>
                        <div id="fileDetails"></div>
                        <button id="confirmUpload" style="background: #28a745;">‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É</button>
                        <button id="cancelUpload" style="background: #dc3545;">‚ùå –û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>
            </section>

            <div id="playlist-sections"></div>
        </main>
    </div>

    <!-- –ü–ª–µ–µ—Ä -->
    <div class="spotify-player" id="spotifyPlayer">
        <div class="player-left">
            <div class="now-playing">
                <div id="nowPlayingArt" class="album-art">üéµ</div>
                <div class="track-info">
                    <div id="nowPlayingTitle" class="track-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–∫</div>
                    <div id="nowPlayingArtist" class="track-artist">‚Äî</div>
                </div>
            </div>
        </div>

        <div class="player-center">
            <div class="player-controls">
                <button class="control-btn repeat-btn" onclick="toggleRepeat()" title="–ó–∞—Ü–∏–∫–ª–∏—Ç—å —Ç—Ä–µ–∫">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M0 4.75A3.75 3.75 0 0 1 3.75 1h8.5A3.75 3.75 0 0 1 16 4.75v5a3.75 3.75 0 0 1-3.75 3.75H9.81l1.018 1.018a.75.75 0 1 1-1.06 1.06L6.939 12.75l2.829-2.828a.75.75 0 1 1 1.06 1.06L9.811 12h2.439a2.25 2.25 0 0 0 2.25-2.25v-5a2.25 2.25 0 0 0-2.25-2.25h-8.5A2.25 2.25 0 0 0 1.5 4.75v5A2.25 2.25 0 0 0 3.75 12H5v1.5H3.75A3.75 3.75 0 0 1 0 9.75v-5z"/>
                    </svg>
                </button>
                <button class="control-btn" onclick="previousTrack()">‚èÆ</button>
                <button class="control-btn play-pause" onclick="togglePlay()">
                    <div class="play-icon"></div>
                    <div class="pause-icon"></div>
                </button>
                <button class="control-btn" onclick="nextTrack()">‚è≠</button>
                <button class="control-btn shuffle-btn" onclick="toggleShuffle()" title="–°–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M13.151.922a.75.75 0 1 0-1.06 1.06L13.109 3H11.16a3.75 3.75 0 0 0-2.873 1.34l-6.173 7.356A2.25 2.25 0 0 1 .39 12.5H0V14h.391a3.75 3.75 0 0 0 2.873-1.34l6.173-7.356a2.25 2.25 0 0 1 1.724-.804h1.947l-1.017 1.018a.75.75 0 0 0 1.06 1.06L15.98 3.75 13.15.922zM.391 3.5H0V2h.391c1.109 0 2.16.49 2.873 1.34L4.89 5.277l-.979 1.167-1.796-2.14A2.25 2.25 0 0 0 .39 3.5z"/>
                        <path d="m7.5 10.723.98-1.167.957 1.14a2.25 2.25 0 0 0 1.724.804h1.947l-1.017-1.018a.75.75 0 1 1 1.06-1.06l2.829 2.828-2.829 2.828a.75.75 0 1 1-1.06-1.06L13.109 13H11.16a3.75 3.75 0 0 1-2.873-1.34l-.787-.938z"/>
                    </svg>
                </button>
            </div>
            <div class="progress-container">
                <span id="currentTime">0:00</span>
                <div class="progress-bar" onclick="seek(event)">
                    <div class="progress" id="progress"></div>
                </div>
                <span id="duration">0:00</span>
            </div>
        </div>

        <div class="player-right">
    <button class="control-btn volume-btn" onclick="toggleMute()">
        <div class="volume-icon">
            <div class="volume-bar volume-bar-1"></div>
            <div class="volume-bar volume-bar-2"></div>
            <div class="volume-bar volume-bar-3"></div>
            <div class="volume-cross"></div>
        </div>
    </button>
    <input type="range" id="volume" min="0" max="100" value="50" oninput="changeVolume(this.value)">
</div>

        <audio id="audioElement" ontimeupdate="updateProgress()"></audio>
    </div>

    <!-- –ø–ª–µ–π–ª–∏—Å—Ç –æ–∫–Ω–æ -->
    <div id="playlistModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–ª–µ–π–ª–∏—Å—Ç</h3>
            <input type="text" id="playlistName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞">
            <div class="modal-actions">
                <button onclick="savePlaylist()">–°–æ–∑–¥–∞—Ç—å</button>
                <button onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div id="addSongsModal" class="modal" style="display: none;">
        <div class="modal-content songs-selection-modal">
            <h3 id="addSongsModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–∫–∏ –≤ –ø–ª–µ–π–ª–∏—Å—Ç</h3>
        
            <div class="songs-list" id="availableSongsList">
                <!-- –°–ø–∏—Å–æ–∫ —Ç—Ä–µ–∫–æ–≤ -->
            </div>
        
            <div class="modal-actions">
                <button onclick="closeAddSongsModal()">–ì–æ—Ç–æ–≤–æ</button>
            </div>
        </div>
    </div>

    <!-- –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞ -->
    <div id="deletePlaylistModal" class="modal delete-confirmation-modal" style="display: none;">
        <div class="modal-content">
            <h3>üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç</h3>
            <p id="deletePlaylistMessage">–í—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–ª–µ–π–ª–∏—Å—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
            <div class="confirmation-buttons">
                <button class="delete-btn" onclick="confirmDeletePlaylist()">–£–¥–∞–ª–∏—Ç—å</button>
                <button class="cancel-btn" onclick="cancelDeletePlaylist()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div id="metadataModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—Ä–µ–∫–µ</h3>
            <div style="margin-bottom: 16px;">
                <label style="display: block; margin-bottom: 8px; color: #b3b3b3;">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞:</label>
                <input type="text" id="songTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞" style="width: 100%; padding: 12px; background: #404040; border: none; border-radius: 4px; color: white;">
            </div>
            <div style="margin-bottom: 16px;">
                <label style="display: block; margin-bottom: 8px; color: #b3b3b3;">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</label>
                <input type="text" id="songArtist" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è" style="width: 100%; padding: 12px; background: #404040; border: none; border-radius: 4px; color: white;">
            </div>
            <div class="file-preview" id="filePreview" style="background: #1e3a28; padding: 12px; border-radius: 4px; margin-bottom: 16px; display: none;">
                <h4 style="margin-bottom: 8px;">üìÅ –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª:</h4>
                <p style="color: #b3b3b3; font-size: 12px;" id="originalFileName"></p>
            </div>
            <div class="modal-actions">
                <button onclick="confirmMetadata()" style="background: #1db954;">‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç—Ä–µ–∫</button>
                <button onclick="cancelMetadata()" style="background: #dc3545;">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>